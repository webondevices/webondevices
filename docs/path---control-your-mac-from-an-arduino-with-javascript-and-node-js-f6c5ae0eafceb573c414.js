webpackJsonp([17693828271058],{432:function(n,s){n.exports={data:{markdownRemark:{html:'<p><strong>Today, in this quick project we will hookup a simple push button to an Arduino UNO and trigger OS X, operating system level commands from Node.js and JavaScript. In this specific example we will put the computer in sleep and mute the system sound volume when the button is pressed. We will also look at a few other commands you can try by simply changing one line of code.</strong></p>\n<p>This project really is a simple one. The Arduino code will be 7 lines and the Node.js application is 14 lines so I encourage you to try it! We will first check the button state with the Arduino, then send a message through the USB port to the Node.js application where we simply run terminal commands to perform certain tasks.</p>\n<p><img src="http://www.webondevices.com/posts/button.jpg" alt="button"></p>\n<p>If you would like to get started from the very basics of Arduino and Node.js, download my Free ebook which will teach you all the basics in a few hours.</p>\n<h3 id="arduino-part"><a href="#arduino-part" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Arduino part</h3>\n<p>For the button I used a breakout board. This module has three pins: S, V and G. V is what you connect to the 5V pin on the Arduino and G to the GND pin. After this the button is powered up. The last step is to connect the third pin, S (Signal) to one of the input pins of the Arduino. The button connects the supplied 5V voltage from the V pin straight to the S pin but breaks the circuit when you press the button. <strong>This voltage change is what you’re Arduino input pin will detect</strong>. I randomly picked number 6 for this circuit.</p>\n<p>After this I opened up the Arduino IDE and wrote the sketch that first checks whether the button is pressed then <strong>sends a message through the USB port</strong>. This serial message is what we will later pick up and read from Node.js using the serial port library.</p>\n<div class="gatsby-highlight">\n      <pre class="language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">pinMode</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> INPUT<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Serial<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token number">9600</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">void</span> <span class="token function">loop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">digitalRead</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">==</span> LOW<span class="token punctuation">)</span><span class="token punctuation">{</span>\n        Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Clicked"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code></pre>\n      </div>\n<p>This will result in the “Clicked” serial port message sent through the USB when the button is clicked.</p>\n<h3 id="nodejs-server-part"><a href="#nodejs-server-part" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Node.js server part</h3>\n<p>In our Node.js application we first include the Serialport library then save the library instance into another variable. In the third line we load the Shell JS library which will let us <strong>run OS X Terminal commands within the Node.js application</strong>.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">var</span> serialport <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'serialport\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">var</span> SerialPort <span class="token operator">=</span> serialport<span class="token punctuation">.</span>SerialPort<span class="token punctuation">;</span>\n<span class="token keyword">var</span> shelljs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span>\'shelljs<span class="token operator">/</span>global’<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n      </div>\n<p>Next, we create an instance of our USB port by passing in the name of the port, then a settings object that specifies that we will interpret a message when a new line character is received.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">var</span> myUSB <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SerialPort</span><span class="token punctuation">(</span><span class="token string">"/dev/cu.usbmodem1421"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>\n    parser<span class="token operator">:</span> serialport<span class="token punctuation">.</span>parsers<span class="token punctuation">.</span><span class="token function">readline</span><span class="token punctuation">(</span><span class="token string">"\\r\\n"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n      </div>\n<p>The USB port instance has an on data event listener which exposes a data variable containing our message:</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript">myUSB<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"data"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">if</span><span class="token punctuation">(</span>data <span class="token operator">===</span> <span class="token string">"Clicked"</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n        <span class="token comment">// Button was clicked</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n      </div>\n<p>The problem with this piece of code is that when we press the button the Arduino constantly keeps streaming the “Clicked” message one by one until we release the button. This means that whatever we put inside condition will be executed multiple times. To prevent this from happening we only interpret the first message as a click, then disable the functionality for the next five seconds:</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">var</span> enabled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>\n\nmyUSB<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"data"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n    <span class="token keyword">if</span><span class="token punctuation">(</span>data <span class="token operator">===</span> “Clicked” <span class="token operator">&amp;&amp;</span> enable<span class="token punctuation">)</span><span class="token punctuation">{</span>\n        <span class="token comment">// Quickly disable the button</span>\n        enabled <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>\n        <span class="token comment">// Enable after 5 seconds</span>\n        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n            enabled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n        <span class="token comment">// Terminal commands come here</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n      </div>\n<p>After the button logic is sorted let’s look at all the things we can do with OS X from here:</p>\n<div class="gatsby-highlight">\n      <pre class="language-text"><code class="language-text">// Opens up a youtube video (or any other URL)\nexec(&#39;open https://www.youtube.com/watch?v=El9K_EEv8cU&#39;, {silent:true}).output;\n\n// Mutes system volume (or change it to a specific volume from 0 to 10)\nexec(‘osascript -e “set Volume 0&quot;&#39;, {silent:true}).output;\n\n// Puts computer to sleep immediately\nexec(‘pmset sleep now&#39;, {silent:true}).output;\n\n// Mission Control\nexec(‘/Application/Mission\\ Control.app/Contents/MacOS/Mission\\ Control&#39;, {silent:true}).output;\n\n// Show desktop\nexec(‘/Application/Mission\\ Control.app/Contents/MacOS/Mission\\ Control 1&#39;, {silent:true}).output;\n\n// Exposé\nexec(‘/Application/Mission\\ Control.app/Contents/MacOS/Mission\\ Control 2&#39;, {silent:true}).output;</code></pre>\n      </div>\n<p>This is just the beginning and you can obviously add most Terminal commands in here. You could automate a GIT command or a Grunt or Gulp task you often have to use.</p>\n<p><strong>What would you use this script for?</strong></p>',timeToRead:3,excerpt:"Today, in this quick project we will hookup a simple push button to an Arduino UNO and trigger OS X, operating system level commands from…",frontmatter:{title:"Control your Mac from an Arduino with JavaScript and Node.js",cover:"http://www.webondevices.com/posts/button.jpg",date:"22/10/2015",category:"moar",tags:["arduino","javascript"]},fields:{slug:"/control-your-mac-from-an-arduino-with-java-script-and-node-js"}}},pathContext:{slug:"/control-your-mac-from-an-arduino-with-java-script-and-node-js"}}}});
//# sourceMappingURL=path---control-your-mac-from-an-arduino-with-javascript-and-node-js-f6c5ae0eafceb573c414.js.map